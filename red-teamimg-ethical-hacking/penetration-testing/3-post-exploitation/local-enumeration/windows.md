# Windows

## Metasploit Post Modules

### Enumerate Users

<pre><code><strong>post/windows/gather/enum_logged_on_users
</strong></code></pre>

### CheckVM

<pre><code><strong>post/windows/gather/checkvm
</strong></code></pre>

### Applications

It will tell us installed programs on the system

```
post/windows/gather/enum_applications
```

{% hint style="warning" %}
Based of the versions of the programs installed we may find a program vulnerable and can be used for Privilege escalation
{% endhint %}

### Antivirus Exclusions

```
post/windows/gather/enum_av_excluded
```

#### üîç **What it does:**

* It **retrieves directories, file paths, extensions, and processes** that are **excluded** from antivirus scanning.
* These **AV exclusion settings** are often configured by admins (or malware) to reduce performance impact or to avoid false positives.
* Malware can take advantage of these exclusions to **hide in unmonitored areas**.

{% hint style="warning" %}
#### üí° **Why it's useful (Offensive Perspective):**

* Helps an attacker identify **safe locations** to store tools or payloads without being scanned.
* Useful in **red team operations** and **post-exploitation phases** to maintain stealth and persistence.
{% endhint %}

### Network Computers

```
post/windows/gather/enum_computers 
```

### OS patches

```
post/windows/gather/enum_patches
```

#### üîç **What it does:**

* It queries the **target Windows system** to list **installed Microsoft patches**, service packs, or hotfixes.
* Helps attackers or red teamers **determine missing patches** that may be exploited further.
* Provides a quick way to assess the **patch level** of a system after gaining access.

#### ‚úÖ **What it looks for:**

The module uses **WMI (Windows Management Instrumentation)** or **system APIs** to retrieve data about:

* Installed KB numbers (e.g., `KB5021234`)
* Installation date
* Descriptions (if available)

{% hint style="warning" %}
#### üí° **Why it's useful:**

* Helps **identify unpatched vulnerabilities** (e.g., EternalBlue, PrintNightmare).
* Assists in **privilege escalation**, **lateral movement**, or **exploit chaining**.
* Supports post-exploitation **situational awareness**.
{% endhint %}

### &#x20;**Shared folders**

```
post/windows/gather/enum_shares
```

#### üìå Purpose

It gathers a list of **network shares** configured on the target system. These might include:

* **Admin shares** (`C$`, `ADMIN$`)
* **User-created shares** (e.g., `SharedDocs`, `Projects`)
* **Hidden shares** (ending with `$`)

This is useful for **lateral movement**, **data collection**, or further **privilege escalation**.
