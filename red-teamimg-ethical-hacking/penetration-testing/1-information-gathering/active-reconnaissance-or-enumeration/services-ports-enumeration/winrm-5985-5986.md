# WinRM/5985 - 5986

**We look for**&#x20;

```bash
5985/tcp open  http    Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
5986/tcp open  ssl/http Microsoft HTTPAPI httpd 2.0
```

**Check WinRM Authentication Options**

```bash
crackmapexec winrm <target> -u <user> -p <pass>    
```

```bash
crackmapexec winrm <target> -u <user> -H <ntlm_hash>
```

ðŸ§  Summary

| Task           | Tool       | Command                                          |
| -------------- | ---------- | ------------------------------------------------ |
| Port scan      | nmap       | `nmap -p 5985,5986 -sV <target>`                 |
| Test login     | CME        | `cme winrm <target> -u user -H hash`             |
| Remote command | CME        | `cme winrm <target> -u user -H hash -x "whoami"` |
| Full shell     | evil-winrm | `evil-winrm -i <target> -u user -H hash`         |

## evil-winrm

| **Option**                        | **Description / Usage**                                                     |
| --------------------------------- | --------------------------------------------------------------------------- |
| `-i, --ip IP`                     | Remote host IP or hostname. FQDN required for Kerberos auth. **(Required)** |
| `-u, --user USER`                 | Username. **Required if not using Kerberos**                                |
| `-p, --password PASS`             | Password for the user                                                       |
| `-H, --hash HASH`                 | NTHash for authentication                                                   |
| `-P, --port PORT`                 | Remote host port (default: 5985)                                            |
| `-S, --ssl`                       | Enable SSL connection                                                       |
| `-a, --user-agent USERAGENT`      | Specify connection user-agent (default: Microsoft WinRM Client)             |
| `-c, --pub-key PUBLIC_KEY_PATH`   | Local path to public key certificate                                        |
| `-k, --priv-key PRIVATE_KEY_PATH` | Local path to private key certificate                                       |
| `-r, --realm DOMAIN`              | Kerberos auth. Must match `/etc/krb5.conf` format                           |
| `--spn SPN_PREFIX`                | SPN prefix for Kerberos auth (default: HTTP)                                |
| `-s, --scripts PS_SCRIPTS_PATH`   | Local path to PowerShell scripts                                            |
| `-e, --executables EXES_PATH`     | Local path to C# executables                                                |
| `-U, --url URL`                   | Remote URL endpoint (default: /wsman)                                       |
| `-V, --version`                   | Show `evil-winrm` version                                                   |
| `-n, --no-colors`                 | Disable colored output                                                      |
| `-N, --no-rpath-completion`       | Disable remote path completion                                              |
| `-l, --log`                       | Log the WinRM session                                                       |
| `-h, --help`                      | Display the help message                                                    |
